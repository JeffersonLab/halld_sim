#define RDISparam_cxx
#include "RDISparam.h"

//----------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------

double DR1998(double X, double Q2){
  return .0078 - .013*X + (.070 -.39*X + .70* X*X)/(1.7+Q2);
}

//----------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------

void r1998(double X,double Q2,double &R,double &DR) { // cf COMPASS class PaAlgo & Barbara Badelek note 2004-6
  double Q2_LIMIT = 0.5;

  double A[6] = { 4.8520E-02,  5.4704E-01,  2.0621E+00,
                 -3.8036E-01,  5.0896E-01, -2.8548E-02 };
  double B[6] = { 4.8051E-02,  6.1130E-01, -3.5081E-01,
                 -4.6076E-01,  7.1697E-01, -3.1726E-02 };
  double C[6] = { 5.7654E-02,  4.6441E-01,  1.8288E+00,
                  1.2371E+01, -4.3104E+01,  4.1741E+01 };

  double Q2_SAVE = Q2_LIMIT;

  if( Q2 < Q2_LIMIT) {
    Q2_SAVE = Q2;
    Q2 = Q2_LIMIT;
  }

  double FAC   = 1+12.*Q2/(1.+Q2)*(.125*.125/(.125*.125+X*X));
  double RLOG  = FAC/log(Q2/.04);
        // model A
  double QP2 = (A[2-1]/pow(pow(Q2,4)+pow(A[3-1],4),.25)) * (1.+A[4-1]*X +A[5-1]*X*X);
  double R_A = A[1-1]*RLOG + QP2*pow(X,A[6-1]);
        // model B
  QP2 = (1.+B[4-1]*X+B[5-1]*X*X)*(B[2-1]/Q2 + B[3-1]/(Q2*Q2+.09));
  double R_B = B[1-1]*RLOG+QP2*pow(X,B[6-1]);
        // model C
  double Q2thr = C[4-1]*(X) + C[5-1]*X*X +C[6-1]*X*X*X;
         QP2   = C[2-1] / sqrt( (Q2-Q2thr)*(Q2-Q2thr) + C[3-1]*C[3-1] );
  double R_C   = C[1-1]*RLOG + QP2;


         R     = (R_A+R_B+R_C) / 3.;

  double D1    = DR1998(X,Q2);
  double D2    = sqrt( ( (R_A-R)*(R_A-R) + (R_B-R)*(R_B-R) + (R_C-R)*(R_C-R)) /2. );
  double D3    = .023*(1.+.5*R);
  if( Q2 < 1 || X < .1 ) D3 = 1.5*D3;

         DR    = sqrt(D1*D1 + D2*D2 + D3*D3 );

  if( Q2_SAVE < Q2_LIMIT ) {
    R  = 1.1880 * R * (1 - exp(-Q2_SAVE/0.2712) );
    DR = 0.2;
  }

  return;
}

//----------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------












